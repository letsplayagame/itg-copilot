<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ITG CoPilot - Trading Session</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Additional styles for demon log */
        .demon-log {
            margin-top: 30px;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .demon-log-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #eee;
        }

        .demon-log-title {
            font-size: 1.2em;
            font-weight: 600;
            color: var(--status-red);
        }

        .demon-counter {
            background: var(--status-red);
            color: white;
            padding: 5px 15px;
            border-radius: 15px;
            font-weight: 500;
        }

        .demon-log-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .demon-log-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            border-bottom: 1px solid #eee;
            transition: background-color 0.2s;
        }

        .demon-log-item:hover {
            background-color: #f8f8f8;
        }

        .demon-log-time {
            color: var(--warm-gray);
            font-size: 0.9em;
            width: 80px;
        }

        .demon-log-name {
            flex-grow: 1;
            margin: 0 20px;
        }

        .demon-log-lucky {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--warm-gray);
        }

        .demon-log-lucky input[type="checkbox"] {
            margin-right: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="demon-finder">
            <div class="header">
                <h1 class="title">DEMON FINDER</h1>
                <div class="time-section">
                    <div id="current-time" class="time">
                        15:20 ET
                    </div>
                </div>
                <button class="reset-btn" onclick="resetCounts()">Reset</button>
            </div>
            <div class="summary-bar">
                Total mistakes today: <span id="mistake-summary">0</span>
            </div>
            <div class="table-container">
                <table id="demonTable">
                    <thead>
                        <tr>
                            <th>DEMON #</th>
                            <th class="demon-number">1</th>
                            <th class="demon-number">2</th>
                            <th class="demon-number">3</th>
                            <th class="demon-number">4</th>
                            <th class="demon-number">5</th>
                            <th class="demon-number">6</th>
                            <th class="demon-number">7</th>
                            <th class="stop-trading">STOP</th>
                        </tr>
                    </thead>
                    <tbody id="demonTableBody">
                        <!-- Rows will be populated by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>

        <div class="demon-log">
            <div class="demon-log-header">
                <span class="demon-log-title">Demon Log</span>
                <span class="demon-counter">Demon Counter: <span id="log-counter">0</span></span>
            </div>
            <ul class="demon-log-list" id="demonLogList">
                <!-- Log items will be added here dynamically -->
            </ul>
        </div>
    </div>

    <script>
        const mistakes = [
            'Boredom Entry',
            'FOMO Entry',
            'Late Entry',
            'Missed Entry',
            'Poor RR',
            'Added To Loser',
            'Incorrect Size',
            'Premature Exit',
            'Late Exit'
        ];

        let mistakeCounts = {};
        let demonLog = [];

        function initializeCounts() {
            mistakes.forEach(mistake => {
                mistakeCounts[mistake] = 0;
            });
        }

        function updateMistakeSummary() {
            const totalMistakes = Object.values(mistakeCounts).reduce((a, b) => a + b, 0);
            document.getElementById('mistake-summary').textContent = totalMistakes;
            document.getElementById('log-counter').textContent = demonLog.length;
        }

        function getCurrentTime() {
            return new Intl.DateTimeFormat('en-US', {
                timeZone: 'America/New_York',
                hour: '2-digit',
                minute: '2-digit',
                hour12: false
            }).format(new Date());
        }

        function addToLog(mistake) {
            const logEntry = {
                time: getCurrentTime(),
                mistake: mistake,
                lucky: false,
                id: Date.now()
            };
            demonLog.unshift(logEntry);
            updateLogDisplay();
        }

        function toggleLucky(id) {
            const entry = demonLog.find(e => e.id === id);
            if (entry) {
                entry.lucky = !entry.lucky;
            }
        }

        function updateLogDisplay() {
            const logList = document.getElementById('demonLogList');
            logList.innerHTML = '';

            demonLog.forEach(entry => {
                const li = document.createElement('li');
                li.className = 'demon-log-item';
                li.innerHTML = `
                    <span class="demon-log-time">${entry.time}</span>
                    <span class="demon-log-name">${entry.mistake}</span>
                    <label class="demon-log-lucky">
                        <input type="checkbox" 
                               ${entry.lucky ? 'checked' : ''} 
                               onchange="toggleLucky(${entry.id})">
                        Lucky
                    </label>
                `;
                logList.appendChild(li);
            });
            updateMistakeSummary();
        }

        function createTable() {
            const tbody = document.getElementById('demonTableBody');
            tbody.innerHTML = '';
            
            mistakes.forEach(mistake => {
                const row = document.createElement('tr');
                
                // Mistake name cell
                const mistakeCell = document.createElement('td');
                mistakeCell.className = 'mistake-cell';
                mistakeCell.textContent = mistake;
                mistakeCell.onclick = () => incrementCount(mistake);
                row.appendChild(mistakeCell);

                // Count cells
                for (let i = 0; i < 7; i++) {
                    const cell = document.createElement('td');
                    cell.className = 'checkmark';
                    cell.textContent = i < mistakeCounts[mistake] ? '✓' : '';
                    row.appendChild(cell);
                }

                // Stop trading cell
                const stopCell = document.createElement('td');
                stopCell.className = 'stop-trading';
                stopCell.textContent = mistakeCounts[mistake] >= 7 ? '⚠' : '';
                row.appendChild(stopCell);

                tbody.appendChild(row);
            });
            
            updateMistakeSummary();
        }

        function incrementCount(mistake) {
            if (mistakeCounts[mistake] < 7) {
                mistakeCounts[mistake]++;
                addToLog(mistake);
                createTable();
            }
        }

        function resetCounts() {
            mistakes.forEach(mistake => {
                mistakeCounts[mistake] = 0;
            });
            demonLog = [];
            createTable();
            updateLogDisplay();
        }

        function updateTime() {
            document.getElementById('current-time').textContent = `${getCurrentTime()} ET`;
        }

        // Initialize the application
        initializeCounts();
        createTable();
        setInterval(updateTime, 1000);
        updateTime();
    </script>
</body>
</html>
